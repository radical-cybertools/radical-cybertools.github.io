<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>RADICAL Cybertools | RADICAL-Pilot</title>

    <!-- Bootstrap -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/simplex-theme.min.css" rel="stylesheet">
    <link href="../css/jumbotron.css" rel="stylesheet">
    <link href="../css/stickyfooter.css" rel="stylesheet">
    <link href="../css/main.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>


    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a href="../index.html" class="navbar-brand">RADICAL Cybertools</a>
          <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div class="navbar-collapse collapse" id="navbar-main">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="themes">Tools <span class="caret"></span></a>
              <ul class="dropdown-menu" aria-labelledby="themes">
                <li><a href="../saga-python/index.html">RADICAL-SAGA</a></li>
                <li><a href="../radical-pilot/index.html">RADICAL-Pilot</a></li>
                <li><a href="../ensemble-md/index.html">EnsembleMD Toolkit</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="themes">Quick Links <span class="caret"></span></a>
              <ul class="dropdown-menu" aria-labelledby="themes">
                <li><a href="./try_it_online.html">Try It Online!</a></li>
                <li><a href="./quick_start.html">Quick Start</a></li>
                <li><a href="./index.html">More Info</a></li>
                <li><a href="http://radicalpilot.readthedocs.org/en/latest">Documentation</a></li>
                <li><a href="https://github.com/radical-cybertools/radical.pilot">Github Project</a></li>
              </ul>
            </li>
            <li>
              <a href="http://radical.rutgers.edu/publications/">Publications</a>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="mailto:shantenu.jha@rutgers.edu?subject=RADICAL Cybertools" target="_blank">Contact</a></li>
          </ul>

        </div>
      </div>
    </div>


    <!-- ========== -->
    <script>
var Executed = 0;
function execute1(){    
		document.getElementById("output1").innerHTML = '';
		setTimeout(myTimeout1, (Math.random()*1000)) 
}
function myTimeout1() {
  document.getElementById("output1").innerHTML = '<div class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_stream output_stdout output_text"><pre>0.41</pre></div></div></div>';
}

function execute2(){
		document.getElementById("output2").innerHTML = '';
		setTimeout(myTimeout2, (Math.random()*1000))

}
function myTimeout2() {
	document.getElementById("output2").innerHTML = '<div class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_stream output_stdout output_text"><pre>Session id: rp.session.ip-10-144-47-195.radical.016754.0005 Pilot Manager: {&apos;uid&apos;: &apos;pmgr.0005&apos;}</pre></div></div></div>';
		Executed=1;
}

function execute3(){
		document.getElementById("output3").innerHTML = '';
	if (Executed > 0){
			setTimeout(myTimeout3, (Math.random()*1000))
		}
		else{
			document.getElementById("output3").innerHTML='<div class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_stream output_stdout output_text"><pre>Please execute previous Shells</pre></div></div></div>';
		}
}
function myTimeout3() {
	document.getElementById("output3").innerHTML = '<div class="output"><div class="output_area"><div class="output_html rendered_html output_subarea output_execute_result"><div><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th></th><th>Value</th></tr></thead><tbody><tr><th>uid</th><td>umgr.0005</td></tr><tr><th>scheduler</th><td>RoundRobinScheduler</td></tr><tr><th>scheduler_details</th><td>NO SCHEDULER DETAILS (Not Implemented)</td></tr></tbody></table></div></div></div></div>';
	Executed = 2;
}

function execute4(){ 
		document.getElementById("output4").innerHTML = '';
		if (Executed > 1){
				setTimeout(myTimeout4, (Math.random()*1000)) 
			}
		else{
			document.getElementById("output4").innerHTML='<div class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_stream output_stdout output_text"><pre>Please execute previous Shells</pre></div></div></div>';
		}
}
function myTimeout4() {
	document.getElementById("output4").innerHTML = '<div class="output"><div class="output_area"><div class="output_html rendered_html output_subarea output_execute_result"><div><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th></th><th>Value</th></tr></thead><tbody><tr><th>uid</th><td>pilot.0005</td></tr><tr><th>stdout</th><td>None</td></tr><tr><th>start_time</th><td>None</td></tr><tr><th>resource_detail</th><td>{"cores_per_node": None, "nodes": None}</td></tr><tr><th>submission_time</th><td>1447607422.85</td></tr><tr><th>logfile</th><td>None</td></tr><tr><th>resource</th><td>local.localhost</td></tr><tr><th>log</th><td>[]</td></tr><tr><th>sandbox</th><td>file://localhost/home/radical/radical.pilot.sa...</td></tr><tr><th>state</th><td>PendingLaunch</td></tr><tr><th>stop_time</th><td>None</td></tr><tr><th>stderr</th><td>None</td></tr></tbody></table></div></div></div></div>';
		Executed = 3;
}


function execute5(){    
		document.getElementById("output5").innerHTML = '';
		if( Executed > 2){
		setTimeout(myTimeout5, (Math.random()*1000)) }
		else{
			document.getElementById("output5").innerHTML='<div class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_stream output_stdout output_text"><pre>Please execute previous Shells</pre></div></div></div>';
		}
}
function myTimeout5() {
	document.getElementById("output5").innerHTML = '<div class="output"><div class="output_area"><div class="output_html rendered_html output_subarea output_execute_result"><div><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th></th><th>Value</th></tr></thead><tbody><tr><th>kernel</th><td>None</td></tr><tr><th>executable</th><td>/bin/echo</td></tr><tr><th>name</th><td>None</td></tr><tr><th>restartable</th><td>False</td></tr><tr><th>output_staging</th><td>None</td></tr><tr><th>stdout</th><td>None</td></tr><tr><th>pre_exec</th><td>None</td></tr><tr><th>mpi</th><td>False</td></tr><tr><th>environment</th><td>{"CU_NO": 1}</td></tr><tr><th>cleanup</th><td>False</td></tr><tr><th>arguments</th><td>["I am CU number $CU_NO"]</td></tr><tr><th>stderr</th><td>None</td></tr><tr><th>cores</th><td>1</td></tr><tr><th>post_exec</th><td>None</td></tr><tr><th>input_staging</th><td>None</td></tr></tbody></table></div></div></div></div>';
		Executed = 4;
}

function execute6() {
		document.getElementById("output6").innerHTML = '';
		if (Executed > 3){
				setTimeout(myTimeout6, 2000) 
				setTimeout(myTimeout7, 4000) 
				setTimeout(myTimeout8, 6000+(Math.random()*1000)) }
		else{
			document.getElementById("output6").innerHTML='<div class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_stream output_stdout output_text"><pre>Please execute previous Shells</pre></div></div></div>';
		}
}
function myTimeout6() {
	document.getElementById("output6").innerHTML = '<div class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_stream output_stdout output_text"><pre>Submit Compute Units to Unit Manager ...</pre></div></div></div>';
}
function myTimeout7() {
	document.getElementById("output6").innerHTML = '<div class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_stream output_stdout output_text"><pre>Submit Compute Units to Unit Manager ...<br>Waiting for CUs to complete ...</pre></div></div></div>';
}
function myTimeout8() {
	document.getElementById("output6").innerHTML = '<div class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_stream output_stdout output_text"><pre>Submit Compute Units to Unit Manager ...<br>Waiting for CUs to complete ...<br>All CUs completed successfully!</pre></div></div></div>';
	Executed = 5;
}


function execute7() {
		document.getElementById("output7").innerHTML = '';
		if (Executed > 4){
				setTimeout(myTimeout9,(Math.random()*1000))}   
		else{
			document.getElementById("output7").innerHTML='<div class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_stream output_stdout output_text"><pre>Please execute previous Shells</pre></div></div></div>';
		} 
}
function myTimeout9() {
	document.getElementById("output7").innerHTML = '<div class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_stream output_stdout output_text"><pre>I am CU number 1</pre></div></div></div>';
	Executed = 6;
}

function execute8() {
		document.getElementById("output8").innerHTML = '';
		if (Executed > 5){
				setTimeout(myTimeout10,(Math.random()*1000)) }
		else{
			document.getElementById("output8").innerHTML='<div class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_stream output_stdout output_text"><pre>Please execute previous Shells</pre></div></div></div>';
		}
}
function myTimeout10() {
	document.getElementById("output8").innerHTML = '<div class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_stream output_stdout output_text"><pre>Session closed</pre></div></div></div>';
	Executed =0;
}
</script>

<div class="container">
 <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="RADICAL-Pilot-Tutorial">RADICAL-Pilot Tutorial<a class="anchor-link" href="#RADICAL-Pilot-Tutorial"></a></h1><p>Utilize the examples below to familiarize yourself with RADICAL-Pilot.</p>
<p>We will:</p>
<ul>
<li>Modify settings (environment variables) if needed</li>
<li>Modify the example to print out the hostname of the machine that runs the Pilot</li>
</ul>
<p><strong>Please make sure that you always close the session before terminating the notebook using <code>session.close()</code></strong></p>
<h2 id="1-RADICAL-Pilot-Setup">1 RADICAL-Pilot Setup<a class="anchor-link" href="#1-RADICAL-Pilot-Setup"></a></h2><p>Documentation: <a href="http://radicalpilot.readthedocs.org/en/latest/machconf.html#preconfigured-resources">http://radicalpilot.readthedocs.org/en/latest/machconf.html#preconfigured-resources</a></p>
<p>First, we will import the necessary dependencies and define some helper functions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
		<div class="input_area">
<div class=" highlight hl-ipython2"><pre>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">radical.pilot</span> <span class="kn">as</span> <span class="nn">rp</span>

<span class="o"></span>radicalpilot-version
</pre></div>

</div>
</div>
</div>
<button onclick="execute1()">Execute</button>


<div class="output_wrapper" id="output1">

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Local-Pilot-Example">2. Local Pilot Example<a class="anchor-link" href="#2.-Local-Pilot-Example"></a></h2><p>This example shows how to execute a task using a Pilot-Job running on the local machine. In this case, the Pilot-Job is started using <strong>ssh</strong> on the edge node machine of the Hadoop cluster (which runs Jupyterhub - the iPython notebook server).</p>
<h3 id="2.1-Create-a-new-Session-and-Pilot-Manager.">2.1 Create a new Session and Pilot-Manager.<a class="anchor-link" href="#2.1-Create-a-new-Session-and-Pilot-Manager."></a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
		<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">session</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">pmgr</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">PilotManager</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
<span class="n">umgr</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">UnitManager</span> <span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">,</span>
											 <span class="n">scheduler</span><span class="o">=</span><span class="n">rp</span><span class="o">.</span><span class="n">SCHED_ROUND_ROBIN</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Session id: </span><span class="si">%s</span><span class="s2"> Pilot Manager: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pmgr</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()))</span>
</pre></div>

</div>
</div>
</div>
<button onclick="execute2()">Execute</button>
<div class="output_wrapper" id="output2">

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
		<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">print_details</span><span class="p">(</span><span class="n">umgr</span><span class="o">.</span><span class="n">as_dict</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<button onclick="execute3()">Execute</button>

<div class="output_wrapper" id="output3">

</div>


</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.2-Submit-Pilot-and-add-to-Unit-Manager">2.2 Submit Pilot and add to Unit Manager<a class="anchor-link" href="#2.2-Submit-Pilot-and-add-to-Unit-Manager"></a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
		<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">pdesc</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">ComputePilotDescription</span><span class="p">()</span>
<span class="n">pdesc</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="s2">&quot;local.localhost&quot;</span>  <span class="c1"># NOTE: This is a &quot;label&quot;, not a hostname</span>
<span class="n">pdesc</span><span class="o">.</span><span class="n">runtime</span>  <span class="o">=</span> <span class="mi">10</span> <span class="c1"># minutes</span>
<span class="n">pdesc</span><span class="o">.</span><span class="n">cores</span>    <span class="o">=</span> <span class="mi">2</span>
<span class="n">pdesc</span><span class="o">.</span><span class="n">cleanup</span>  <span class="o">=</span> <span class="bp">True</span>
<span class="n">pilot</span> <span class="o">=</span> <span class="n">pmgr</span><span class="o">.</span><span class="n">submit_pilots</span><span class="p">(</span><span class="n">pdesc</span><span class="p">)</span>
<span class="n">umgr</span><span class="o">.</span><span class="n">add_pilots</span><span class="p">(</span><span class="n">pilot</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
		<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">print_details</span><span class="p">(</span><span class="n">pilot</span><span class="o">.</span><span class="n">as_dict</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<button onclick="execute4()">Execute</button>




<div class="output_wrapper" id="output4">

</div>


</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.3-Submit-Compute-Units">2.3 Submit Compute Units<a class="anchor-link" href="#2.3-Submit-Compute-Units"></a></h3><p>Create a description of the compute unit, which specifies the details of the task to be executed.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
		<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">cudesc</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">ComputeUnitDescription</span><span class="p">()</span>
<span class="n">cudesc</span><span class="o">.</span><span class="n">environment</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CU_NO&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">cudesc</span><span class="o">.</span><span class="n">executable</span>  <span class="o">=</span> <span class="s2">&quot;/bin/echo&quot;</span>
<span class="n">cudesc</span><span class="o">.</span><span class="n">arguments</span>   <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;I am CU number $CU_NO&#39;</span><span class="p">]</span>
<span class="n">cudesc</span><span class="o">.</span><span class="n">cores</span>       <span class="o">=</span> <span class="mi">1</span>
<span class="n">print_details</span><span class="p">(</span><span class="n">cudesc</span><span class="o">.</span><span class="n">as_dict</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>
<button onclick="execute5()">Execute</button>


<div class="output_wrapper" id="output5">

</div>


</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Submit the previously created ComputeUnit descriptions to the PilotManager. This will trigger the selected scheduler (in this case the round-robin scheduler) to start assigning ComputeUnits to the ComputePilots.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
		<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span> <span class="s2">&quot;Submit Compute Units to Unit Manager ...&quot;</span>
<span class="n">cu_set</span> <span class="o">=</span> <span class="n">umgr</span><span class="o">.</span><span class="n">submit_units</span><span class="p">([</span><span class="n">cudesc</span><span class="p">])</span>
<span class="k">print</span> <span class="s2">&quot;Waiting for CUs to complete ...&quot;</span>
<span class="n">umgr</span><span class="o">.</span><span class="n">wait_units</span><span class="p">()</span>
<span class="k">print</span> <span class="s2">&quot;All CUs completed successfully!&quot;</span>
<span class="n">cu_results</span> <span class="o">=</span> <span class="n">cu_set</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">details</span><span class="o">=</span><span class="n">cu_results</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>
<button onclick="execute6()">Execute</button>


<div class="output_wrapper" id="output6">

</div>

</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Parse the output of the CU</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
		<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span> <span class="n">cu_results</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<button onclick="execute7()">Execute</button>


<div class="output_wrapper" id="output7">

</div>

</div>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.6-Close-and-Delete-Session">2.6 Close Session<a class="anchor-link" href="#2.6-Close-and-Delete-Session"></a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
		<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>
<button onclick="execute8()">Execute</button>


<div class="output_wrapper" id="output8">

</div>

</div>

</div>
    <div id="footer">
      <div class="container">
        <p align="center">Copyright &copy; 2014 <a href="http://radical.rutgers.edu">RADICAL Research</a> at 
          <a href="http://www.rutgers.edu">
          Rutgers University </a></p>
      </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/smoothscroll.js"></script>
  </body>
</html>
